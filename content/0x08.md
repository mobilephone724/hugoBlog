---
title: "Create Index"
date: 2024-08-13T21:14:00+08:00
---



## 0x0 Steps

1. access method



## 0x1 Access Method



### 0x11 find access method

```txt
(gdb) p accessMethodName 
$1 = 0xaaaabab3f408 "btree"
```



build tuple descriptor

### 0x12 heap create

1. create file
2. create storeage
   1. write WALpage 页有 special offset
   2. register delete
3. create relcache



## 0x2 insert into catalog

insert pg_class

insert pg_attribute

insert pg_index

invalid relcache(register)



## 0x3 dependency

create constraint and dependency

operator class dependency

Collation dependency





## 0x4 "access method" build



decide parallel worker number

enter into `btbuild` function



## 0x05 scan heap

* `heapam_index_build_range_scan`
  * snapshot is important
  * callback function to process the `indexIt`
  * 





















